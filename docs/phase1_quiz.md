# Rust フェーズ1 確認テスト

このテストでは、Rustの基礎と開発環境について理解度を確認します。
各問題に対して、コードを書いたり、説明を記述したりしてください。

---

## 問題1: 開発環境の理解（10点）

以下の質問に日本語で回答してください。

### 1.1 rustupとcargoの役割（各2点）
- `rustup`の主な役割を2つ挙げ、具体的なコマンド例とともに説明してください。
- `cargo`の主な機能を3つ挙げ、それぞれのコマンド例を示してください。

### 1.2 プロジェクト構造（3点）
`cargo new my_project`を実行した後のディレクトリ構造を示し、各ファイル・ディレクトリの役割を説明してください。

### 1.3 エラーメッセージの活用（3点）
Rustのコンパイラエラーメッセージが他の言語と比べて優れている点を2つ挙げ、実際のエラーメッセージの例を用いて説明してください。

---

## 問題2: 基本的なデータ型と変数（15点）

### 2.1 型推論と型注釈（5点）
以下のコードを完成させてください。各変数に適切な型注釈を付け、その理由を説明してください。

```rust
fn main() {
    // 型注釈を追加してください
    let integer = 42;
    let float = 3.14;
    let is_rust_fun = true;
    let emoji = '🦀';

    // 以下の行でコンパイルエラーが起きないようにしてください
    let sum = integer + 10;
    let half = float / 2.0;

    println!("Results: {}, {}", sum, half);
}
```

### 2.2 型変換（5点）
以下の要件を満たすプログラムを作成してください：
- `i32`型の変数を`f64`型に変換する
- 文字列リテラル`"42"`を`i32`型に変換する（エラー処理は不要）
- 変換前後の値を表示する

### 2.3 スコープとシャドーイング（5点）
以下のコードの出力を予想し、その理由を説明してください：

```rust
fn main() {
    let x = 5;
    let x = x + 1;

    {
        let x = x * 2;
        println!("Inner scope: x = {}", x);
    }

    println!("Outer scope: x = {}", x);

    let spaces = "   ";
    let spaces = spaces.len();
    println!("Spaces: {}", spaces);
}
```

---

## 問題3: 可変性とメモリ安全性（15点）

### 3.1 可変性の理解（5点）
以下のコードにはコンパイルエラーがあります。エラーを修正し、なぜRustがデフォルトで不変なのか説明してください。

```rust
fn main() {
    let score = 0;

    for i in 1..=5 {
        score += i;
        println!("Round {}: score = {}", i, score);
    }

    println!("Final score: {}", score);
}
```

### 3.2 定数と不変変数の違い（5点）
以下の要件を満たすプログラムを作成してください：
- 円周率を表す定数`PI`を定義する（値は3.14159）
- 半径を表す不変変数を定義する
- 円の面積を計算して表示する
- 定数（`const`）と不変変数（`let`）の違いを3つ挙げる

### 3.3 メモリ安全性の実例（5点）
Rustがコンパイル時にメモリ安全性を保証する例として、以下のC言語風のコードがRustではどのように書かれ、なぜ安全になるのか説明してください：

```c
// C言語の危険なコード例
int* create_array() {
    int arr[5] = {1, 2, 3, 4, 5};
    return arr;  // ローカル配列のアドレスを返す（危険！）
}
```

---

## 問題4: 関数とエラーハンドリングの基礎（20点）

### 4.1 関数の設計（10点）
以下の要件を満たす関数を実装してください：

```rust
// 華氏温度を摂氏温度に変換する関数
// 引数: fahrenheit (f64型) - 華氏温度
// 戻り値: f64型 - 摂氏温度
// 変換式: (華氏 - 32) × 5/9

// 関数を実装してください

fn main() {
    let temps_f = vec![32.0, 68.0, 100.0, 212.0];

    for temp_f in temps_f {
        let temp_c = // 関数を呼び出してください
        println!("{:.1}°F = {:.1}°C", temp_f, temp_c);
    }
}
```

### 4.2 複数の戻り値（5点）
タプルを使って複数の値を返す関数を作成してください：
- 関数名: `calculate_stats`
- 引数: 整数のスライス `&[i32]`
- 戻り値: (最小値, 最大値, 合計) のタプル `(i32, i32, i32)`
- 空のスライスの場合は `(0, 0, 0)` を返す

### 4.3 早期リターン（5点）
以下の関数を早期リターンを使って改善してください：

```rust
fn get_grade(score: u32) -> &'static str {
    let grade;

    if score >= 90 {
        grade = "A";
    } else if score >= 80 {
        grade = "B";
    } else if score >= 70 {
        grade = "C";
    } else if score >= 60 {
        grade = "D";
    } else {
        grade = "F";
    }

    grade
}
```

---

## 問題5: 制御フロー（20点）

### 5.1 条件分岐の応用（7点）
以下の要件を満たすプログラムを作成してください：
- ユーザーの年齢（整数）を受け取る関数を作成
- 年齢に応じて以下のメッセージを返す：
  - 0-12歳: "子供料金が適用されます"
  - 13-17歳: "学生料金が適用されます"
  - 18-64歳: "大人料金が適用されます"
  - 65歳以上: "シニア料金が適用されます"
- `match`式と`if`式の両方のバージョンを実装

### 5.2 ループの使い分け（7点）
以下の3つのタスクを、それぞれ最適なループ構文を使って実装してください：

1. 1から100までの3の倍数の合計を計算
2. ユーザーが"quit"と入力するまで入力を受け付ける（疑似コード可）
3. 配列`[10, 20, 30, 40, 50]`の各要素とそのインデックスを表示

### 5.3 FizzBuzzの拡張（6点）
標準的なFizzBuzzに以下の拡張を加えたプログラムを作成してください：
- 1から30までの数で実行
- 3の倍数: "Fizz"
- 5の倍数: "Buzz"
- 7の倍数: "Bazz"
- 複数の条件を満たす場合は組み合わせる（例: 15は"FizzBuzz"、21は"FizzBazz"）

---

## 問題6: 実践的な統合問題（20点）

### 6.1 簡単な計算機プログラム（10点）
以下の要件を満たす計算機プログラムを作成してください：

```rust
// 四則演算を行う列挙型
enum Operation {
    Add,
    Subtract,
    Multiply,
    Divide,
}

// 計算を実行する関数を実装してください
fn calculate(a: f64, b: f64, op: Operation) -> Option<f64> {
    // 実装してください
    // ゼロ除算の場合はNoneを返す
}

fn main() {
    // テストケースを作成し、各演算の結果を表示してください
}
```

### 6.2 コマンドライン引数の処理（10点）
以下の要件を満たすプログラムを作成してください：
- コマンドライン引数から2つの数値を受け取る
- 引数が不足している場合は使用方法を表示
- 数値に変換できない場合はエラーメッセージを表示
- 2つの数値の最大公約数（GCD）を計算して表示

ヒント：ユークリッドの互除法を使用

```rust
use std::env;

fn gcd(mut a: u32, mut b: u32) -> u32 {
    // 実装してください
}

fn main() {
    let args: Vec<String> = env::args().collect();

    // 引数の処理とGCD計算を実装してください
}
```

---

## ボーナス問題: Rustらしいコード（10点）

以下のPythonコードをRustで書き直し、Rustの特徴（型安全性、パターンマッチング、イテレータなど）を活かした実装にしてください：

```python
def process_numbers(numbers):
    result = []
    for i, num in enumerate(numbers):
        if num % 2 == 0:
            result.append(f"Index {i}: {num} is even")
        else:
            result.append(f"Index {i}: {num} is odd")
    return result

numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
for line in process_numbers(numbers):
    print(line)
```

---

## 提出方法

1. 各問題の解答をMarkdownファイルまたはRustソースファイルとして作成
2. 動作確認したコードは`cargo fmt`と`cargo clippy`を実行してから提出
3. Gitリポジトリにコミットし、学習の記録として保存

---

## 評価基準

- **正確性（40%）**: コードが正しく動作し、要件を満たしているか
- **Rustらしさ（30%）**: Rustのイディオムや慣習に従っているか
- **可読性（20%）**: コードが読みやすく、適切にコメントされているか
- **エラー処理（10%）**: 適切なエラー処理が行われているか

合計100点満点で、80点以上で合格とします。
